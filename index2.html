<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stop losing customers to hidden bugs | stuck.wtf</title>
    <!-- Variable EB Garamond font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Oswald font -->
    <link href="https://fonts.googleapis.com/css2?family=Oswald&display=swap" rel="stylesheet">

    <link href="https://fonts.googleapis.com/css2?family=Kaushan+Script&display=swap" rel="stylesheet">
    <!-- Tailwind via CDN for quick prototyping. Replace with self‑hosted build for prod -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root{
            --accent:#c90f0f;
        }
        /* subtle hero gradient */
        .bg-radial{
            background: radial-gradient(at 50% -20%, rgba(201,15,15,0.12) 0%,transparent 60%);
        }
        /* Apply Oswald to all headings */
        h1,h2, h3, h4, h5, h6 {
            font-family: 'Kaushan Script', cursive;
        }
        /* Scroll‑reveal */
        [data-reveal]{
            opacity:0;
            transform:translateY(40px);
            transition:all .6s cubic-bezier(.215,.61,.355,1);
        }
        [data-reveal].in-view{
            opacity:1;
            transform:none;
        }
    </style>
</head>
<body class="min-h-screen font-['Noto_Sans'] text-black bg-white bg-radial antialiased scroll-smooth">
<!-- Sticky nav -->
<header class="sticky top-0 z-40 bg-white/70 backdrop-blur border-b border-slate-100">
    <div class="container mx-auto px-4 max-w-7xl flex items-center justify-between py-3">
        <a href="#" class="font-semibold tracking-tight text-lg"><img src="./stuck-logo-1.png" alt="" style="max-width: 100px"></a>
        <nav class="hidden md:flex gap-6 text-sm">
            <a href="#features" class="hover:text-[var(--accent)]">Why us</a>
            <a href="#how" class="hover:text-[var(--accent)]">How it works</a>
            <a href="#pricing" class="hover:text-[var(--accent)]">Pricing</a>
        </nav>
        <div class="flex items-center gap-3">
            <a href="#pricing" class="text-sm hover:text-[var(--accent)]">Login</a>
        </div>
    </div>
</header>

<!-- Hero Section -->
<section class="py-16 md:py-24">
    <div class="container mx-auto px-4 max-w-6xl text-center" data-reveal>
        <h1 class="text-4xl md:text-6xl lg:text-7xl font-bold mb-6 leading-tight">
            Stop losing customers to <span class="text-[var(--accent)]">hidden bugs</span>
        </h1>
        <p class="text-lg md:text-xl text-slate-600 mb-8 max-w-3xl mx-auto">
            Real-time visual reports from shoppers help you fix issues <b>before</b> they kill your revenue.
        </p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
            <a href="#pricing" class="bg-[var(--accent)] text-white px-8 py-3 rounded-lg hover:bg-[var(--accent)]/90 transition-colors font-medium">
                Start Free Trial
            </a>
        </div>
    </div>
</section>

<!-- Pain Point Section -->
<section class="py-16 bg-white">
    <div class="container mx-auto px-4 max-w-4xl text-center" data-reveal>
        <h2 class="text-3xl md:text-4xl font-bold mb-6 text-black">
            When a single glitch costs €1000+ in revenue a day…
        </h2>
        <p class="text-lg text-slate-600 mb-6 max-w-2xl mx-auto">
            You updated a plugin. Your checkout suddenly drops conversions. No alerts, no clear logs – only abandoned carts and lost sales.
        </p>
        <p class="text-lg text-slate-600 max-w-2xl mx-auto">
            <strong class="text-[var(--accent)]">stuck.wtf</strong> puts a tiny "Report a problem" button on every page so shoppers can point at the bug the moment it happens.
        </p>
    </div>
</section>

<!-- Features Section -->
<section id="features" class="py-16 bg-slate-50">
    <div class="container mx-auto px-4 max-w-6xl">
        <div class="text-center mb-16" data-reveal>
            <h2 class="text-3xl md:text-4xl font-bold mb-4">Why Choose stuck.wtf?</h2>
            <p class="text-lg text-slate-600 max-w-2xl mx-auto">
                Our advanced monitoring catches bugs in real-time, ensuring your users have the best possible experience.
            </p>
        </div>

        <div class="grid md:grid-cols-3 gap-8">
            <div class="text-center p-6" data-reveal>
                <div class="w-12 h-12 bg-[var(--accent)] rounded-lg mx-auto mb-4 flex items-center justify-center">
                    <span class="text-white text-2xl">🚀</span>
                </div>
                <h3 class="text-xl font-bold mb-2">Recover revenue faster</h3>
                <p class="text-slate-600">See what's broken, where and for whom — in seconds, not days.</p>
            </div>

            <div class="text-center p-6" data-reveal>
                <div class="w-12 h-12 bg-[var(--accent)] rounded-lg mx-auto mb-4 flex items-center justify-center">
                    <span class="text-white text-2xl">💬</span>
                </div>
                <h3 class="text-xl font-bold mb-2">Talk to the buyer</h3>
                <p class="text-slate-600">Automatic chat thanks the customer and keeps them updated while you fix the issue.</p>
            </div>

            <div class="text-center p-6" data-reveal>
                <div class="w-12 h-12 bg-[var(--accent)] rounded-lg mx-auto mb-4 flex items-center justify-center">
                    <span class="text-white text-2xl">🔌</span>
                </div>
                <h3 class="text-xl font-bold mb-2">Fits your stack</h3>
                <p class="text-slate-600">Two-way sync with Jira, Notion, Trello or GitHub. Unlimited users, projects and pageviews.</p>
            </div>
        </div>
    </div>
</section>

<!-- How It Works Section -->
<section id="how" class="py-16">
    <div class="container mx-auto px-4 max-w-6xl">
        <div class="text-center mb-16" data-reveal>
            <h2 class="text-3xl md:text-4xl font-bold mb-4">How it works — 2 min setup</h2>
            <p class="text-lg text-slate-600 max-w-2xl mx-auto">
                From setup to solving customer issues in 6 simple steps.
            </p>
        </div>

        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
            <div class="text-center" data-reveal>
                <div class="w-16 h-16 bg-[var(--accent)] text-white rounded-full mx-auto mb-4 flex items-center justify-center text-2xl font-bold">1</div>
                <h3 class="text-xl font-bold mb-2">Copy Widget Snippet</h3>
                <p class="text-slate-600">Copy your personal widget snippet after signup.</p>
            </div>

            <div class="text-center" data-reveal>
                <div class="w-16 h-16 bg-[var(--accent)] text-white rounded-full mx-auto mb-4 flex items-center justify-center text-2xl font-bold">2</div>
                <h3 class="text-xl font-bold mb-2">Install on Your Store</h3>
                <p class="text-slate-600">Paste it into the header of your Shopify / Woo store.</p>
            </div>

            <div class="text-center" data-reveal>
                <div class="w-16 h-16 bg-[var(--accent)] text-white rounded-full mx-auto mb-4 flex items-center justify-center text-2xl font-bold">3</div>
                <h3 class="text-xl font-bold mb-2">Shoppers Report Issues</h3>
                <p class="text-slate-600">Shoppers click "Report a problem", mark the screen and hit Send.</p>
            </div>

            <div class="text-center" data-reveal>
                <div class="w-16 h-16 bg-[var(--accent)] text-white rounded-full mx-auto mb-4 flex items-center justify-center text-2xl font-bold">4</div>
                <h3 class="text-xl font-bold mb-2">Receive Detailed Reports</h3>
                <p class="text-slate-600">Ticket lands in stuck.wtf (and Jira if linked) with all data attached.</p>
            </div>

            <div class="text-center" data-reveal>
                <div class="w-16 h-16 bg-[var(--accent)] text-white rounded-full mx-auto mb-4 flex items-center justify-center text-2xl font-bold">5</div>
                <h3 class="text-xl font-bold mb-2">Fix & Close</h3>
                <p class="text-slate-600">You fix the bug and close the ticket – the buyer gets an instant "All set!"</p>
            </div>

            <div class="text-center" data-reveal>
                <div class="w-16 h-16 bg-[var(--accent)] text-white rounded-full mx-auto mb-4 flex items-center justify-center text-2xl font-bold">6</div>
                <h3 class="text-xl font-bold mb-2">Revenue Flows Again</h3>
                <p class="text-slate-600">Revenue flows again instead of leaking away.</p>
            </div>
        </div>
    </div>
</section>

<!-- Pricing Section -->
<section id="pricing" class="py-16 bg-slate-50">
    <div class="container mx-auto px-4 max-w-6xl">
        <div class="text-center mb-16" data-reveal>
            <h2 class="text-3xl md:text-4xl font-bold mb-4">Simple Pricing</h2>
            <p class="text-lg text-slate-600 max-w-2xl mx-auto">
                Choose the plan that works best for your business. All plans include our core monitoring features.
            </p>
        </div>

        <div class="grid md:grid-cols-3 gap-8 max-w-5xl mx-auto">
            <div class="bg-white p-8 rounded-2xl border border-slate-200" data-reveal>
                <h3 class="text-xl font-bold mb-2">Starter</h3>
                <div class="mb-6">
                    <span class="text-3xl font-bold">$19</span>
                    <span class="text-slate-600">/month</span>
                </div>
                <ul class="space-y-3 mb-8">
                    <li class="flex items-center">
                        <svg class="w-5 h-5 text-green-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                        </svg>
                        Up to 10K page views
                    </li>
                    <li class="flex items-center">
                        <svg class="w-5 h-5 text-green-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                        </svg>
                        Real-time monitoring
                    </li>
                    <li class="flex items-center">
                        <svg class="w-5 h-5 text-green-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                        </svg>
                        Email alerts
                    </li>
                </ul>
                <a href="#" class="block w-full text-center bg-slate-100 text-black py-3 rounded-lg hover:bg-slate-200 transition-colors">Start free trial</a>
            </div>

            <div class="bg-white p-8 rounded-2xl border-2 border-[var(--accent)] relative" data-reveal>
                <div class="absolute -top-3 left-1/2 transform -translate-x-1/2 bg-[var(--accent)] text-white px-3 py-1 rounded-full text-sm">Popular</div>
                <h3 class="text-xl font-bold mb-2">Professional</h3>
                <div class="mb-6">
                    <span class="text-3xl font-bold">$49</span>
                    <span class="text-slate-600">/month</span>
                </div>
                <ul class="space-y-3 mb-8">
                    <li class="flex items-center">
                        <svg class="w-5 h-5 text-green-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                        </svg>
                        Up to 100K page views
                    </li>
                    <li class="flex items-center">
                        <svg class="w-5 h-5 text-green-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                        </svg>
                        Advanced analytics
                    </li>
                    <li class="flex items-center">
                        <svg class="w-5 h-5 text-green-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                        </svg>
                        Slack/Discord integration
                    </li>
                    <li class="flex items-center">
                        <svg class="w-5 h-5 text-green-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                        </svg>
                        Priority support
                    </li>
                </ul>
                <a href="#" class="block w-full text-center bg-[var(--accent)] text-white py-3 rounded-lg hover:bg-[var(--accent)]/90 transition-colors">Start free trial</a>
            </div>

            <div class="bg-white p-8 rounded-2xl border border-slate-200" data-reveal>
                <h3 class="text-xl font-bold mb-2">Enterprise</h3>
                <div class="mb-6">
                    <span class="text-3xl font-bold">$199</span>
                    <span class="text-slate-600">/month</span>
                </div>
                <ul class="space-y-3 mb-8">
                    <li class="flex items-center">
                        <svg class="w-5 h-5 text-green-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                        </svg>
                        Unlimited page views
                    </li>
                    <li class="flex items-center">
                        <svg class="w-5 h-5 text-green-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                        </svg>
                        Custom integrations
                    </li>
                    <li class="flex items-center">
                        <svg class="w-5 h-5 text-green-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                        </svg>
                        Dedicated support
                    </li>
                    <li class="flex items-center">
                        <svg class="w-5 h-5 text-green-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                        </svg>
                        SLA guarantee
                    </li>
                </ul>
                <a href="#" class="block w-full text-center bg-slate-100 text-black py-3 rounded-lg hover:bg-slate-200 transition-colors">Contact Sales</a>
            </div>
        </div>
    </div>
</section>

<!-- Footer -->
<footer class="py-12 bg-black text-white">
    <div class="container mx-auto px-4 max-w-6xl">
        <div class="text-center mb-8">
            <img src="./stuck-logo-1.png" alt="stuck.wtf" class="mx-auto mb-4" style="max-width: 100px; filter: brightness(0) invert(1);">
            <p class="text-slate-400 text-sm max-w-2xl mx-auto">Stop losing customers to hidden bugs with our real-time monitoring solution.</p>
        </div>

        <div class="border-t border-slate-800 pt-8 flex flex-col md:flex-row justify-between items-center">
            <p class="text-slate-400 text-sm">© 2025 stuck.wtf. All rights reserved.</p>
            <div class="flex items-center gap-6 mt-4 md:mt-0">
                <a href="#features" class="text-slate-400 hover:text-white text-sm">Features</a>
                <a href="#how" class="text-slate-400 hover:text-white text-sm">How it works</a>
                <a href="#pricing" class="text-slate-400 hover:text-white text-sm">Pricing</a>
            </div>
        </div>
    </div>
</footer>

<!-- Виджет обратной связи -->
<div class="feedback-widget">
    <button class="feedback-btn" onclick="startScreenshot()">Report a problem</button>
</div>

<!-- Оверлей для скриншота -->
<div class="screenshot-overlay" id="screenshotOverlay">
    <!-- Canvas для рисования аннотаций -->
    <canvas id="annotationCanvas"></canvas>

    <!-- Панель инструментов -->
    <div class="screenshot-toolbar">
        <div class="toolbar-section">
            <button class="tool-btn active" data-tool="arrow" title="Стрелка">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M7 17L17 7M17 7H7M17 7V17"/>
                </svg>
            </button>
            <button class="tool-btn" data-tool="rectangle" title="Прямоугольник">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                </svg>
            </button>
            <button class="tool-btn" data-tool="circle" title="Круг">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                </svg>
            </button>
            <button class="tool-btn" data-tool="pen" title="Рисование">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/>
                </svg>
            </button>
        </div>

        <div class="toolbar-section">
            <div class="color-picker">
                <button class="color-btn active" data-color="#ff0000" style="background: #ff0000;"></button>
                <button class="color-btn" data-color="#00ff00" style="background: #00ff00;"></button>
                <button class="color-btn" data-color="#0000ff" style="background: #0000ff;"></button>
                <button class="color-btn" data-color="#ffff00" style="background: #ffff00;"></button>
                <button class="color-btn" data-color="#ff00ff" style="background: #ff00ff;"></button>
            </div>
        </div>

        <div class="toolbar-section">
            <button class="action-btn" onclick="clearAnnotations()" title="Очистить">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="3,6 5,6 21,6"/>
                    <path d="M19,6V20a2,2,0,0,1-2,2H7a2,2,0,0,1-2-2V6M8,6V4a2,2,0,0,1,2-2h4a2,2,0,0,1,2,2V6"/>
                </svg>
            </button>
            <button class="action-btn" onclick="undoAnnotation()" title="Отменить">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 7v6h6"/>
                    <path d="M21 17a9 9 0 00-9-9 9 9 0 00-6 2.3L3 13"/>
                </svg>
            </button>
        </div>

        <div class="toolbar-section">
            <button class="action-btn cancel-btn" onclick="cancelScreenshot()">Отмена</button>
            <button class="action-btn save-btn" onclick="finishScreenshot()">Готово</button>
        </div>
    </div>
</div>

<!-- Pop-up окно для отправки отчета -->
<div class="feedback-popup" id="feedbackPopup">
    <div class="feedback-modal">
        <button class="feedback-close" onclick="closeFeedback()">&times;</button>

        <div id="feedbackForm">
            <div class="feedback-header">
                <h3>🐛 Report a problem</h3>
                <p>Добавьте описание к вашему скриншоту</p>
            </div>

            <form class="feedback-form" onsubmit="submitFeedback(event)">
                <div class="screenshot-preview">
                    <img id="screenshotPreview" src="" alt="Screenshot" style="max-width: 100%; border-radius: 8px;">
                </div>

                <div>
                    <label for="problemType">Тип проблемы</label>
                    <select id="problemType" required>
                        <option value="">Выберите тип проблемы...</option>
                        <option value="page-not-loading">Страница не загружается</option>
                        <option value="button-not-working">Кнопка не работает</option>
                        <option value="checkout-issue">Проблема с оформлением заказа</option>
                        <option value="display-issue">Проблема с отображением</option>
                        <option value="slow-loading">Медленная загрузка</option>
                        <option value="other">Другое</option>
                    </select>
                </div>

                <div>
                    <label for="userEmail">Ваш email (опционально)</label>
                    <input type="email" id="userEmail" placeholder="your@email.com">
                </div>

                <div>
                    <label for="problemDescription">Описание проблемы</label>
                    <textarea id="problemDescription" required placeholder="Опишите, что вы пытались сделать и что пошло не так..."></textarea>
                </div>

                <div class="feedback-actions">
                    <button type="button" class="feedback-btn-secondary" onclick="closeFeedback()">Отмена</button>
                    <button type="submit" class="feedback-btn-primary">Отправить отчет</button>
                </div>
            </form>
        </div>

        <div id="successMessage" class="success-message" style="display: none;">
            <h3>✅ Спасибо!</h3>
            <p>Мы получили ваш отчет и сразу займемся расследованием проблемы.</p>
            <p>Мы будем держать вас в курсе по email, если вы его указали.</p>
            <button class="feedback-btn-primary" onclick="closeFeedback()">Закрыть</button>
        </div>
    </div>
</div>

<style>
/* Виджет обратной связи - адаптированный под стилистику index2 */
.feedback-widget {
    position: fixed;
    right: -2px;
    top: 50%;
    transform: translateY(-50%);
    z-index: 1000;
}

.feedback-btn {
    background: var(--accent);
    color: white;
    border: none;
    padding: 12px 6px;
    writing-mode: vertical-lr;
    text-orientation: mixed;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    border-radius: 8px 0 0 8px;
    box-shadow: -2px 0 10px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
    font-family: 'Noto Sans', sans-serif;
}

.feedback-btn:hover {
    background: #b60e0e;
    transform: translateX(-3px);
}

/* Стили для скриншота */
.screenshot-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    z-index: 9999;
    display: none;
    cursor: crosshair;
}

.screenshot-overlay.active {
    display: block;
}

#annotationCanvas {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    cursor: crosshair;
}

.screenshot-toolbar {
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: white;
    border-radius: 12px;
    padding: 12px 16px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    display: flex;
    gap: 16px;
    align-items: center;
    font-family: 'Noto Sans', sans-serif;
    z-index: 10000;
}

.toolbar-section {
    display: flex;
    gap: 8px;
    align-items: center;
    border-right: 1px solid #e2e8f0;
    padding-right: 16px;
}

.toolbar-section:last-child {
    border-right: none;
    padding-right: 0;
}

.tool-btn, .action-btn {
    width: 36px;
    height: 36px;
    border: 1px solid #e2e8f0;
    background: white;
    border-radius: 8px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
    color: #64748b;
}

.tool-btn:hover, .action-btn:hover {
    background: #f8fafc;
    border-color: #cbd5e1;
}

.tool-btn.active {
    background: var(--accent);
    border-color: var(--accent);
    color: white;
}

.color-picker {
    display: flex;
    gap: 4px;
}

.color-btn {
    width: 24px;
    height: 24px;
    border: 2px solid white;
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.2s;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.color-btn.active {
    border-color: #1e293b;
    transform: scale(1.1);
}

.cancel-btn, .save-btn {
    width: auto;
    padding: 8px 16px;
    font-size: 14px;
    font-weight: 600;
}

.cancel-btn {
    background: #f8fafc;
    color: #64748b;
}

.save-btn {
    background: var(--accent);
    color: white;
    border-color: var(--accent);
}

.save-btn:hover {
    background: #b60e0e;
}

.feedback-popup {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.5);
    z-index: 10001;
    display: none;
    align-items: center;
    justify-content: center;
}

.feedback-popup.active {
    display: flex;
}

.feedback-modal {
    background: white;
    border-radius: 16px;
    padding: 24px;
    max-width: 480px;
    width: 90%;
    max-height: 80vh;
    overflow-y: auto;
    position: relative;
    animation: slideIn 0.3s ease;
    font-family: 'Noto Sans', sans-serif;
}

@keyframes slideIn {
    from { transform: scale(0.9); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
}

.feedback-close {
    position: absolute;
    top: 16px;
    right: 16px;
    background: none;
    border: none;
    font-size: 24px;
    cursor: pointer;
    color: #64748b;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: background 0.2s;
}

.feedback-close:hover {
    background: #f1f5f9;
}

.feedback-header {
    margin-bottom: 20px;
    padding-right: 40px;
}

.feedback-header h3 {
    margin: 0 0 8px 0;
    color: #1e293b;
    font-size: 20px;
    font-family: 'Oswald', cursive;
}

.feedback-header p {
    margin: 0;
    color: #64748b;
    font-size: 14px;
}

.feedback-form {
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.screenshot-preview {
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    padding: 8px;
    background: #f8fafc;
}

.feedback-form label {
    font-weight: 600;
    color: #1e293b;
    margin-bottom: 4px;
    display: block;
    font-size: 14px;
}

.feedback-form input,
.feedback-form textarea,
.feedback-form select {
    width: 100%;
    padding: 12px;
    border: 1px solid #d1d5db;
    border-radius: 8px;
    font-family: 'Noto Sans', sans-serif;
    font-size: 14px;
    box-sizing: border-box;
    transition: border-color 0.2s, box-shadow 0.2s;
}

.feedback-form textarea {
    resize: vertical;
    min-height: 100px;
}

.feedback-form input:focus,
.feedback-form textarea:focus,
.feedback-form select:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(201, 15, 15, 0.1);
}

.feedback-actions {
    display: flex;
    gap: 12px;
    justify-content: flex-end;
    margin-top: 20px;
}

.feedback-btn-secondary {
    background: #f8f9fa;
    color: #64748b;
    border: 1px solid #d1d5db;
    padding: 10px 20px;
    border-radius: 8px;
    cursor: pointer;
    font-family: 'Noto Sans', sans-serif;
    font-size: 14px;
    transition: all 0.2s;
}

.feedback-btn-secondary:hover {
    background: #e2e8f0;
}

.feedback-btn-primary {
    background: var(--accent);
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 8px;
    cursor: pointer;
    font-family: 'Noto Sans', sans-serif;
    font-size: 14px;
    font-weight: 600;
    transition: all 0.2s;
}

.feedback-btn-primary:hover {
    background: #b60e0e;
}

.feedback-btn-primary:disabled {
    background: #94a3b8;
    cursor: not-allowed;
}

.success-message {
    text-align: center;
    padding: 40px 20px;
}

.success-message h3 {
    color: #059669;
    margin-bottom: 12px;
    font-family: 'Oswald', cursive;
}

.success-message p {
    color: #64748b;
    margin-bottom: 20px;
}

@media (max-width: 768px) {
    .feedback-modal {
        margin: 20px;
        width: calc(100% - 40px);
    }

    .feedback-actions {
        flex-direction: column;
    }

    .feedback-btn-secondary,
    .feedback-btn-primary {
        width: 100%;
    }

    .screenshot-toolbar {
        flex-direction: column;
        gap: 8px;
        padding: 8px;
        max-width: 90%;
    }

    .toolbar-section {
        border-right: none;
        border-bottom: 1px solid #e2e8f0;
        padding-bottom: 8px;
        padding-right: 0;
    }

    .toolbar-section:last-child {
        border-bottom: none;
        padding-bottom: 0;
    }
}
</style>

<script>
// HTML2Canvas library for screenshots
const loadHtml2Canvas = () => {
    if (window.html2canvas) return Promise.resolve();

    return new Promise((resolve) => {
        const script = document.createElement('script');
        script.src = 'https://html2canvas.hertzen.com/dist/html2canvas.min.js';
        script.onload = resolve;
        document.head.appendChild(script);
    });
};

// Переменные для аннотаций
let isDrawing = false;
let currentTool = 'arrow';
let currentColor = '#ff0000';
let annotations = [];
let canvas, ctx;
let startX, startY;
let backgroundImage = null;

async function startScreenshot() {
    try {
        // Загружаем html2canvas если его нет
        await loadHtml2Canvas();

        // Создаем скриншот страницы
        const screenshotCanvas = await html2canvas(document.body, {
            height: window.innerHeight,
            width: window.innerWidth,
            scrollX: 0,
            scrollY: 0,
            useCORS: true,
            allowTaint: true,
            scale: 1
        });

        // Показываем оверлей
        const overlay = document.getElementById('screenshotOverlay');
        overlay.classList.add('active');

        // Инициализируем canvas
        initCanvas();

        // Отображаем скриншот как фон
        displayScreenshotBackground(screenshotCanvas);

        // Инициализируем инструменты
        initTools();

    } catch (error) {
        console.error('Ошибка создания скриншота:', error);
        alert('Не удалось создать скриншот. Попробуйте еще раз.');
    }
}

function initCanvas() {
    canvas = document.getElementById('annotationCanvas');
    ctx = canvas.getContext('2d');

    // Устанавливаем размеры canvas
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    // Обработчики событий для рисования
    canvas.addEventListener('mousedown', startDrawing);
    canvas.addEventListener('mousemove', draw);
    canvas.addEventListener('mouseup', stopDrawing);
    canvas.addEventListener('touchstart', handleTouch);
    canvas.addEventListener('touchmove', handleTouch);
    canvas.addEventListener('touchend', handleTouch);
}

function displayScreenshotBackground(screenshotCanvas) {
    // Создаем фоновое изображение из скриншота
    const overlay = document.getElementById('screenshotOverlay');
    const dataURL = screenshotCanvas.toDataURL();

    overlay.style.backgroundImage = `url(${dataURL})`;
    overlay.style.backgroundSize = 'cover';
    overlay.style.backgroundPosition = 'top left';
    overlay.style.backgroundRepeat = 'no-repeat';

    // Сохраняем для финального скриншота
    backgroundImage = screenshotCanvas;
}

function initTools() {
    // Инициализация кнопок инструментов
    document.querySelectorAll('.tool-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            document.querySelectorAll('.tool-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            currentTool = btn.dataset.tool;
            updateCursor();
        });
    });

    // Инициализация цветов
    document.querySelectorAll('.color-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            document.querySelectorAll('.color-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            currentColor = btn.dataset.color;
        });
    });
}

function updateCursor() {
    const overlay = document.getElementById('screenshotOverlay');
    switch(currentTool) {
        case 'pen':
            overlay.style.cursor = 'crosshair';
            break;
        case 'arrow':
        case 'rectangle':
        case 'circle':
            overlay.style.cursor = 'crosshair';
            break;
        default:
            overlay.style.cursor = 'crosshair';
    }
}

function startDrawing(e) {
    isDrawing = true;
    const rect = canvas.getBoundingClientRect();
    startX = e.clientX - rect.left;
    startY = e.clientY - rect.top;

    if (currentTool === 'pen') {
        ctx.beginPath();
        ctx.moveTo(startX, startY);
    }
}

function draw(e) {
    if (!isDrawing) return;

    const rect = canvas.getBoundingClientRect();
    const currentX = e.clientX - rect.left;
    const currentY = e.clientY - rect.top;

    ctx.strokeStyle = currentColor;
    ctx.lineWidth = 3;
    ctx.lineCap = 'round';

    if (currentTool === 'pen') {
        ctx.lineTo(currentX, currentY);
        ctx.stroke();
    }
}

function stopDrawing(e) {
    if (!isDrawing) return;
    isDrawing = false;

    const rect = canvas.getBoundingClientRect();
    const endX = e.clientX - rect.left;
    const endY = e.clientY - rect.top;

    ctx.strokeStyle = currentColor;
    ctx.lineWidth = 3;
    ctx.lineCap = 'round';

    switch(currentTool) {
        case 'arrow':
            drawArrow(startX, startY, endX, endY);
            break;
        case 'rectangle':
            ctx.strokeRect(startX, startY, endX - startX, endY - startY);
            break;
        case 'circle':
            const radius = Math.sqrt(Math.pow(endX - startX, 2) + Math.pow(endY - startY, 2));
            ctx.beginPath();
            ctx.arc(startX, startY, radius, 0, 2 * Math.PI);
            ctx.stroke();
            break;
    }

    // Сохраняем состояние для отмены действий
    annotations.push(canvas.toDataURL());
}

function drawArrow(fromX, fromY, toX, toY) {
    const headLength = 15;
    const angle = Math.atan2(toY - fromY, toX - fromY);

    // Рисуем линию
    ctx.beginPath();
    ctx.moveTo(fromX, fromY);
    ctx.lineTo(toX, toY);
    ctx.stroke();

    // Рисуем наконечник стрелки
    ctx.beginPath();
    ctx.moveTo(toX, toY);
    ctx.lineTo(toX - headLength * Math.cos(angle - Math.PI / 6), toY - headLength * Math.sin(angle - Math.PI / 6));
    ctx.moveTo(toX, toY);
    ctx.lineTo(toX - headLength * Math.cos(angle + Math.PI / 6), toY - headLength * Math.sin(angle + Math.PI / 6));
    ctx.stroke();
}

function handleTouch(e) {
    e.preventDefault();
    const touch = e.touches[0] || e.changedTouches[0];
    const mouseEvent = new MouseEvent(e.type === 'touchstart' ? 'mousedown' :
                                     e.type === 'touchmove' ? 'mousemove' : 'mouseup', {
        clientX: touch.clientX,
        clientY: touch.clientY
    });
    canvas.dispatchEvent(mouseEvent);
}

function clearAnnotations() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    annotations = [];
}

function undoAnnotation() {
    if (annotations.length > 0) {
        annotations.pop();
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        if (annotations.length > 0) {
            const img = new Image();
            img.onload = () => {
                ctx.drawImage(img, 0, 0);
            };
            img.src = annotations[annotations.length - 1];
        }
    }
}

function cancelScreenshot() {
    document.getElementById('screenshotOverlay').classList.remove('active');
    clearAnnotations();
}

async function finishScreenshot() {
    try {
        // Создаем финальное изображение, объединяя фон и аннотации
        const finalCanvas = document.createElement('canvas');
        finalCanvas.width = canvas.width;
        finalCanvas.height = canvas.height;
        const finalCtx = finalCanvas.getContext('2d');

        // Рисуем фоновый скриншот
        if (backgroundImage) {
            finalCtx.drawImage(backgroundImage, 0, 0);
        }

        // Рисуем аннотации сверху
        finalCtx.drawImage(canvas, 0, 0);

        // Конвертируем в base64
        const finalScreenshot = finalCanvas.toDataURL('image/png');

        // Скрываем оверлей
        document.getElementById('screenshotOverlay').classList.remove('active');

        // Показываем форму отправки с превью
        showFeedbackForm(finalScreenshot);

    } catch (error) {
        console.error('Ошибка при создании финального скриншота:', error);
        alert('Ошибка при обработке скриншота');
    }
}

function showFeedbackForm(screenshot) {
    const popup = document.getElementById('feedbackPopup');
    const preview = document.getElementById('screenshotPreview');

    preview.src = screenshot;
    popup.classList.add('active');

    // Сохраняем скриншот для отправки
    window.currentScreenshot = screenshot;
}

function closeFeedback() {
    document.getElementById('feedbackPopup').classList.remove('active');
    document.getElementById('feedbackForm').style.display = 'block';
    document.getElementById('successMessage').style.display = 'none';

    // Очищаем форму
    document.querySelector('.feedback-form').reset();
}

function submitFeedback(event) {
    event.preventDefault();

    // Симуляция отправки
    const submitBtn = event.target.querySelector('.feedback-btn-primary');
    submitBtn.disabled = true;
    submitBtn.textContent = 'Отправка...';

    setTimeout(() => {
        document.getElementById('feedbackForm').style.display = 'none';
        document.getElementById('successMessage').style.display = 'block';

        // Здесь можно добавить реальную отправку данных на сервер
        console.log('Screenshot data:', window.currentScreenshot);
        console.log('Form data:', {
            type: document.getElementById('problemType').value,
            email: document.getElementById('userEmail').value,
            description: document.getElementById('problemDescription').value
        });

        submitBtn.disabled = false;
        submitBtn.textContent = 'Отправить отчет';
    }, 2000);
}

// Инициализация при загрузке страницы
document.addEventListener('DOMContentLoaded', function() {
    // Scroll reveal анимация
    function initScrollReveal() {
        const revealElements = document.querySelectorAll('[data-reveal]');

        function checkReveal() {
            const windowHeight = window.innerHeight;

            revealElements.forEach(element => {
                const elementTop = element.getBoundingClientRect().top;
                const elementVisible = 150; // Элемент становится видимым за 150px до появления в окне

                if (elementTop < windowHeight - elementVisible) {
                    element.classList.add('in-view');
                }
            });
        }

        // Проверяем при загрузке
        checkReveal();

        // Проверяем при скролле
        window.addEventListener('scroll', checkReveal);

        // Проверяем при изменении размера окна
        window.addEventListener('resize', checkReveal);
    }

    // Инициализируем scroll reveal
    initScrollReveal();
});
</script>

</body>
</html>
